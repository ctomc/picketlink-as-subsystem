<subsystem xmlns="urn:jboss:domain:picketlink:1.0">
  <identity-management jndi-name="picketlink/FileBasedPartitionManager" alias="file.based.partition.manager">
    <identity-configuration name="file.config">
      <file-store working-dir="/tmp/pl-idm-complete" always-create-files="true" async-write="true"
                  async-write-thread-pool="10">
        <supportedTypes supportsAll="true"/>
      </file-store>
    </identity-configuration>
  </identity-management>

  <identity-management jndi-name="picketlink/JPADSBasedPartitionManager" alias="jpa.ds.based.partition.manager">
    <identity-configuration name="jpa.config">
      <jpa-store data-source="jboss/datasources/ExampleDS">
        <supportedTypes supportsAll="true"/>
      </jpa-store>
    </identity-configuration>
  </identity-management>

  <identity-management jndi-name="picketlink/JPAEMFBasedPartitionManager" alias="jpa.emf.based.partition.manager">
    <identity-configuration name="jpa.config">
      <jpa-store entity-manager-factory="jboss/TestingIDMEMF">
        <supportedTypes>
          <supportedType class="org.picketlink.idm.model.Partition"/>
          <supportedType class="org.picketlink.idm.model.IdentityType"/>
          <supportedType class="org.picketlink.idm.model.Relationship"/>
        </supportedTypes>
      </jpa-store>
    </identity-configuration>
  </identity-management>

  <identity-management
          jndi-name="picketlink/JPACustomEntityBasedPartitionManager"
          alias="jpa.custom.entity.based.partition.manager">
    <identity-configuration name="jpa.config">
      <jpa-store entity-module="org.picketlink.test" entity-module-unit-name="custom-pu" module="org.picketlink.test">
        <supportedTypes>
          <supportedType class="org.picketlink.idm.model.Partition"/>
          <supportedType class="org.picketlink.idm.model.IdentityType"/>
          <supportedType class="org.picketlink.idm.model.Relationship"/>
        </supportedTypes>
        <credential-handlers>
          <credential-handler class="test.org.picketlink.as.subsystem.module.idm.SaleAgentPasswordCredentialHandler"/>
        </credential-handlers>
      </jpa-store>
    </identity-configuration>
  </identity-management>

  <identity-management jndi-name="picketlink/LDAPBasedPartitionManager" alias="ldap.based.partition.manager">
    <identity-configuration name="ldap.config">
      <ldap-store url="ldap://localhost:10389" bind-dn="uid=admin,ou=system" bind-credential="secret"
                  base-dn-suffix="dc=jboss,dc=org">
        <supportedTypes>
          <supportedType class="org.picketlink.idm.model.IdentityType"/>
          <supportedType class="org.picketlink.idm.model.Relationship"/>
        </supportedTypes>
        <mappings>
          <mapping class="org.picketlink.idm.model.basic.Agent" base-dn-suffix="ou=Agent,dc=jboss,dc=org"
                   object-classes="account">
            <attribute name="loginName" ldap-name="uid" is-identifier="true"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.User" base-dn-suffix="ou=People,dc=jboss,dc=org"
                   object-classes="inetOrgPerson, organizationalPerson">
            <attribute name="loginName" ldap-name="uid" is-identifier="true"/>
            <attribute name="firstName" ldap-name="cn"/>
            <attribute name="lastName" ldap-name="sn"/>
            <attribute name="email" ldap-name="uid"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.Role" base-dn-suffix="ou=Roles,dc=jboss,dc=org"
                   object-classes="groupOfNames">
            <attribute name="name" ldap-name="cn" is-identifier="true"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.Group" base-dn-suffix="ou=Groups,dc=jboss,dc=org"
                   object-classes="groupOfNames" parent-membership-attribute-name="member">
            <attribute name="name" ldap-name="cn" is-identifier="true"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.Grant" relates-to="org.picketlink.idm.model.basic.Role">
            <attribute name="assignee" ldap-name="member"/>
          </mapping>
        </mappings>
      </ldap-store>
    </identity-configuration>
  </identity-management>

  <identity-management jndi-name="picketlink/MultiConfigBasedPartitionManager"
                       alias="multi.config.based.partition.manager">
    <identity-configuration name="jpa.config">
      <jpa-store entity-module="org.picketlink.test.multiconfig" entity-module-unit-name="multi-config-pu"
                 support-credential="false" support-attribute="true">
        <supportedTypes>
          <supportedType class="org.picketlink.idm.model.Relationship"/>
        </supportedTypes>
      </jpa-store>
    </identity-configuration>
    <identity-configuration name="ldap.config">
      <ldap-store url="ldap://localhost:10389" bind-dn="uid=admin,ou=system" bind-credential="secret"
                  base-dn-suffix="dc=jboss,dc=org" support-credential="true">
        <supportedTypes>
          <supportedType class="org.picketlink.idm.model.IdentityType"/>
        </supportedTypes>
        <mappings>
          <mapping class="org.picketlink.idm.model.basic.Agent" base-dn-suffix="ou=Agent,dc=jboss,dc=org"
                   object-classes="account">
            <attribute name="loginName" ldap-name="uid" is-identifier="true"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.User" base-dn-suffix="ou=People,dc=jboss,dc=org"
                   object-classes="inetOrgPerson, organizationalPerson">
            <attribute name="loginName" ldap-name="uid" is-identifier="true"/>
            <attribute name="firstName" ldap-name="cn"/>
            <attribute name="lastName" ldap-name="sn"/>
            <attribute name="email" ldap-name="uid"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.Role" base-dn-suffix="ou=Roles,dc=jboss,dc=org"
                   object-classes="groupOfNames">
            <attribute name="name" ldap-name="cn" is-identifier="true"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.Group" base-dn-suffix="ou=Groups,dc=jboss,dc=org"
                   object-classes="groupOfNames" parent-membership-attribute-name="member">
            <attribute name="name" ldap-name="cn" is-identifier="true"/>
            <attribute name="createdDate" ldap-name="createTimeStamp" read-only="true"/>
          </mapping>
          <mapping class="org.picketlink.idm.model.basic.Grant" relates-to="org.picketlink.idm.model.basic.Role">
            <attribute name="assignee" ldap-name="member"/>
          </mapping>
        </mappings>
      </ldap-store>
    </identity-configuration>
  </identity-management>

</subsystem>